<!-- table -->
<div class="table-box shadow-lg mx-auto my-3 my-md-5">

    <h2 class="mb-3"> {{ globalHeader | translate }} </h2>

    <div class="form-row mb-3">

        <!-- admin combo -->
        <div class="col-md-3 my-2 my-md-0" *ngIf="containsProfile ('ADMIN');">
            <select #scheduleCombo class="form-control"
                (change)="toggleVisibility (scheduleCombo.value, statusCombo.value);">
                <option value="all"> {{ 'global.other.all' | translate }} {{ 'global.menu-links.schedules' | translate }} </option>
                <option value="my" selected> {{ 'global.other.my' | translate }} {{ 'global.menu-links.schedules' | translate }} </option>
            </select>
        </div>

        <!-- status combo -->
        <div class="col-md-4 my-2 my-md-0" [hidden]="!isHidden">
            <div class="input-group">
                <div class="input-group-prepend">
                    <span class="input-group-text"> {{ 'meeting-schedules.current-status' | translate }} </span>
                </div>
                <select #statusCombo class="form-control" (change)="filterStatus (statusCombo.value);">
                    <option *ngFor="let status of listMeetingStatus(); let currentIndex = index;" [value]="status"> {{ statusDescriptions[currentIndex] | translate }} </option>
                </select>
            </div>
        </div>

        <!-- new meeting schedule -->
        <div class="col-md-3 my-2 my-md-0" *ngIf="containsProfile ('EMPLOYEE');" [hidden]="isHidden">
            <button type="button" class="btn btn-success btn-block" (click)="showNewMeetingScheduleModal ();"> {{ 'global.buttons.new-meeting-schedule' | translate }} </button>
        </div>
    </div>

    <div *ngIf="records$ | async as schedules; else spanLoading;">
        <div class="table-responsive" *ngIf="!hasError && schedules.length !== 0; else nothingFound">
            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th scope="col" *ngFor="let header of tableHeaders"> 
                            {{ header | translate }}
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let schedule of schedules;">
                        <td scope="row">
                            <input type="radio" name="id" class="custom-radio" (click)="toggleButtons (schedule)">
                        </td>

                        <td scope="row"> {{ schedule.getDatetime () }} </td>
                        <td scope="row"> {{ schedule.getEmployee ()?.getName () }} </td>
                        <td scope="row"> {{ schedule.getStudent ()?.getName () }} </td>
                        
                        <td scope="row">
                            <span [class]="setBagdeClass (schedule.getMeetingStatus ())">
                                {{ getTranslatedStatus (schedule.getMeetingStatus ()) | translate }} 
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- actions -->
        <div *ngIf="containsProfile ('EMPLOYEE') && schedules.length !== 0">
            <div class="row" [hidden]="isHidden">
                <div class="col-md-3">
                    <button type="button" class="btn btn-danger btn-block mt-2" disabled #cancelScheduleButton (click)="onUpdate ();"> {{ 'meeting-schedules.buttons.cancel-schedule' | translate }} </button>
                </div>
                <div class="col-md-3">
                    <button type="button" class="btn btn-primary btn-block mt-2" disabled #newReportButton (click)="showNewReportModal ();"> {{ 'global.buttons.new-report' | translate }} </button>
                </div>
            </div>
        </div>
    </div>

    <ng-template #spanLoading>
        <div class="bg-light p-3 text-center">
            <span *ngIf="!hasError; else spanError;"> {{ 'global.messages.loading' | translate }} {{ 'global.menu-links.schedules' | translate }} ... </span>
        </div>
    </ng-template>

    <ng-template #spanError>
        <span> {{ 'global.messages.system-error' | translate }} </span>
        <button type="button" class="btn btn-info mx-1" (click)="onReload ()"> {{ 'global.buttons.reload' | translate }} </button>
    </ng-template>

    <ng-template #nothingFound>
        <div class="bg-light p-3 text-center">
            <span> {{ 'global.messages.nothing-found' | translate }} </span>
        </div>
    </ng-template>
</div>