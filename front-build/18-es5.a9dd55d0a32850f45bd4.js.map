{"version":3,"sources":["webpack:///src/app/views/students/students-list/students-list.component.html","webpack:///src/app/views/students/students-routing.module.ts","webpack:///src/app/views/students/students-list/students-list.component.ts","webpack:///src/app/views/students/students.module.ts"],"names":["StudentsListComponent","StudentsRoutingModule","StudentsModule","ROUTES","path","component","translateService","storageService","studentService","imageUtilService","modalService","super","this","globalHeader","params","set","records$","loadData","hasError","recordsCount","value","queryField","findAllByName","pipe","map","students","length","student","dto","Object","assign","imageUrl","environment","BUCKET_BASE_URL","buildFileName","getName","setImageUrl","imageElement","document","createElement","src","addEventListener","DEFAULT_AVATAR_IMG","catchError","error$","next","handleError","modalTexts","error","title","loading","body","onSearch","forChild"],"mappings":"g7CA8BoB,iBACI,iBACI,iBACI,QACJ,OACA,iBACA,iBACI,eAAsB,QAA0B,OACpD,OACJ,OACJ,Q,uBAR2C,kCAC/B,kCAEuB,0FAED,oC,yBAT1C,iBACI,iBACI,uBAWJ,OACJ,Q,uBAZkD,2B,sBAe9C,iBACI,Q,oBACJ,Q,MADI,iE,yBApBhB,gBACI,gBACI,uBAgBA,yCAKJ,OACJ,Q,4BAtBqC,qDAAuC,e,sBA0BpE,eACI,Q,wCAEJ,Q,MAFI,0G,yBAFR,iBACI,wBAIJ,Q,6BAJW,iCAAiB,e,qCAQ5B,eAAO,Q,oBAAiD,OACxD,oBAAgD,2DAC5C,Q,oBACJ,O,MAHO,+DAEH,yDC3DZ,ICgBaA,EDLAC,EEKAC,EFhBPC,EAAiB,CACrB,CACEC,KAAM,GACNC,WCaSL,EAAN,a,kOAAA,U,MAAA,OAEL,WACYM,EACAC,EACFC,EACAC,EACEC,2BAEVC,cAAML,EAAkBC,EAAgBG,IAN9BJ,mBACA,EAAAC,iBACF,EAAAC,iBACA,EAAAC,mBACE,EAAAC,eAGVE,EAAKC,aAAe,6BAHVH,EAPP,O,EAAA,G,EAAA,kCAcHE,KAAKE,OAASF,KAAKE,OAAOC,IAAI,OAAQ,IACtCH,KAAKI,SAAWJ,KAAKK,SAASL,KAAKE,UAfhC,yGAqBHF,KAAKM,YACLN,KAAKO,aAAe,EAEpB,IAAIC,EAAQR,KAAKS,WAAWD,MAC5BA,EAASA,GAAgB,GAEzBR,KAAKE,OAASF,KAAKE,OAAOC,IAAI,OAAQK,GACtCR,KAAKI,SAAWJ,KAAKK,SAASL,KAAKE,UA5BhC,+BA+BcA,cACjB,OAAOF,KAAKJ,eAAec,cAAcR,GAAQS,KAC/C,OAAAC,EAAA,GAAIC,YAAQ,OACVb,EAAKO,aAAeM,EAASC,OAEtBD,EAASD,IAAKG,YACnBf,EAAKM,YAEL,IAAMU,EAAM,IAAI,IAChBC,OAAOC,OAAOF,EAAKD,GAGnB,IAAII,EAAWC,EAAA,EAAYC,gBAC3BF,GAAQ,WAAQnB,EAAKH,iBAAiByB,cAAcN,EAAIO,WAAhD,QACRP,EAAIQ,YAAYL,GAEhB,IAAMM,EAAeC,SAASC,cAAc,OAI5C,OAHAF,EAAaG,IAAMT,EACnBM,EAAaI,iBAAiB,QAAS,kBAAMb,EAAIQ,YAAYJ,EAAA,EAAYU,sBAElEd,MAIX,OAAAe,EAAA,GAAY,kBACV/B,EAAKM,YACLN,EAAKgC,OAAOC,SACZjC,EAAKkC,YAAalC,EAAKmC,WAAWC,MAAMC,MAAOrC,EAAKmC,WAAWG,QAAQC,MAChE,Y,2BA3DR,GAAoC,K,sCAA9BnD,GAAqB,oD,uBAArBA,EAAqB,+2B,GAAA,MFnBlC,oBACI,iBACI,eAA8B,Q,oBAA+B,OACjE,OAEA,aAGA,gBACI,gBACI,gBACI,kB,qBAEA,iBACI,oBAA8C,+BAAS,EAAAoD,aACnD,S,qBACJ,OACJ,OACJ,OACJ,OACJ,OAEA,cAEA,uB,iBA0BA,yCASA,0CAMJ,Q,oBA/DsC,+CASkB,yCAA0B,4DAI1D,0DASF,4CAAuB,gB,wECVtC,IAAMnD,EAAN,yB,qBAAMA,I,oDAAAA,IAAqB,SAHvB,CAAC,IAAaoD,SAASlD,IACtB,O,2BEOL,IAAMD,EAAN,yB,qBAAMA,I,oDAAAA,IAAc,SAThB,CACP,IACA,EACA,IACA,IACA,IACA,Q","file":"x","sourcesContent":["\r\n<!-- students -->\r\n<article class=\"card-box shadow-lg mx-auto my-md-5 my-3\">\r\n    <header>\r\n        <h1 class=\"mb-3 text-center\"> {{ globalHeader | translate }} </h1>\r\n    </header>\r\n\r\n    <hr>\r\n\r\n    <!-- search -->\r\n    <div class=\"row\">\r\n        <div class=\"col-12\">\r\n            <div class=\"input-group mb-3\">\r\n                <input type=\"text\" class=\"form-control\" [formControl]=\"queryField\" \r\n                    [placeholder]=\"'global.messages.search-for-name' | translate\">\r\n                <div class=\"input-group-append\">\r\n                    <button type=\"button\" class=\"btn btn-success\" (click)=\"onSearch ();\">\r\n                        {{ 'global.buttons.search' | translate }}\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <hr>\r\n\r\n    <div class=\"row\" *ngIf=\"records$ | async as students; else spanLoading;\">\r\n        <div class=\"col-12\">\r\n            <div class=\"card-container\" *ngIf=\"!hasError && recordsCount !== 0; else emptyTemplate\">\r\n                <div class=\"row row-cols-1 row-cols-md-4\">\r\n                    <div class=\"col mb-4\" *ngFor=\"let student of students;\">\r\n                        <div class=\"card card-list-item\">\r\n                            <div class=\"card-header card-name\" [title]=\"student.getName ()\"> \r\n                                {{ student.getName () }} \r\n                            </div>\r\n                            <img class=\"m-2 img-fluid\" [src]=\"student?.getImageUrl() || 'assets/images/avatar-blank.png'\" alt=\"student\">\r\n                            <div class=\"card-body\">\r\n                                <p class=\"card-text\"> {{ student.getEmail () }} </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <ng-template #emptyTemplate>\r\n                <div class=\"bg-light p-3 text-center\">\r\n                    {{ 'global.messages.nothing-found' | translate }}\r\n                </div>\r\n            </ng-template>\r\n        </div>\r\n    </div>\r\n\r\n    <ng-template #spanLoading>\r\n        <div class=\"bg-light p-3 text-center\">\r\n            <span *ngIf=\"!hasError; else spanError;\"> \r\n                {{ 'global.messages.loading' | translate }} \r\n                {{ 'global.menu-links.students' | translate }} ... \r\n            </span>\r\n        </div>\r\n    </ng-template>\r\n\r\n    <ng-template #spanError>\r\n        <span> {{ 'global.messages.system-error' | translate }} </span>\r\n        <button type=\"button\" class=\"btn btn-info mx-1\" (click)=\"onSearch ()\"> \r\n            {{ 'global.buttons.reload' | translate }} \r\n        </button>\r\n    </ng-template>\r\n</article>","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { StudentsListComponent } from './students-list/students-list.component';\r\n\r\nconst ROUTES: Routes = [\r\n  {\r\n    path: '',\r\n    component: StudentsListComponent,\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(ROUTES)],\r\n  exports: [RouterModule]\r\n})\r\nexport class StudentsRoutingModule { }\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { HttpParams } from '@angular/common/http';\r\nimport { Observable, EMPTY } from 'rxjs';\r\nimport { map, catchError } from 'rxjs/operators';\r\n\r\nimport { environment } from 'src/environments/environment';\r\n\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { StorageService } from 'src/app/services/storage.service';\r\nimport { StudentService } from 'src/app/services/domain/student.service';\r\nimport { ImageUtilService } from 'src/app/services/image-util.service';\r\nimport { ModalService } from 'src/app/services/modal.service';\r\n\r\nimport { StudentDTO } from 'src/app/models/domain/dto/student.dto';\r\n\r\nimport { BaseCardListComponent } from 'src/app/shared/list-table/base-card-list/base-card-list.component';\r\n\r\n@Component({\r\n  selector: 'app-students-list',\r\n  templateUrl: './students-list.component.html'\r\n})\r\nexport class StudentsListComponent extends BaseCardListComponent<StudentDTO> implements OnInit {\r\n\r\n  constructor(\r\n    protected translateService: TranslateService,\r\n    protected storageService: StorageService,\r\n    private studentService: StudentService,\r\n    private imageUtilService: ImageUtilService,\r\n    protected modalService: ModalService,\r\n  ) {\r\n    super(translateService, storageService, modalService);\r\n    this.globalHeader = 'global.menu-links.students';\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.params = this.params.set('name', '');\r\n    this.records$ = this.loadData(this.params);\r\n  }\r\n\r\n  public onDelete(): void { }\r\n  public onUpdate(): void { }\r\n  public onSearch(): void {\r\n    this.hasError = false;\r\n    this.recordsCount = 0;\r\n\r\n    let value = this.queryField.value;\r\n    value = (value ? value : '');\r\n\r\n    this.params = this.params.set('name', value);\r\n    this.records$ = this.loadData(this.params);\r\n  }\r\n\r\n  protected loadData(params?: HttpParams): Observable<StudentDTO[]> {\r\n    return this.studentService.findAllByName(params).pipe(\r\n      map(students => {\r\n        this.recordsCount = students.length;\r\n\r\n        return students.map((student) => {\r\n          this.hasError = false;\r\n\r\n          const dto = new StudentDTO ();\r\n          Object.assign(dto, student);\r\n\r\n          // bucket url\r\n          let imageUrl = environment.BUCKET_BASE_URL;\r\n          imageUrl += `/${this.imageUtilService.buildFileName(dto.getName())}.jpg`;\r\n          dto.setImageUrl(imageUrl);\r\n\r\n          const imageElement = document.createElement('img');\r\n          imageElement.src = imageUrl;\r\n          imageElement.addEventListener('error', () => dto.setImageUrl(environment.DEFAULT_AVATAR_IMG));\r\n\r\n          return dto;\r\n        });\r\n      }),\r\n\r\n      catchError (() => {\r\n        this.hasError = true;\r\n        this.error$.next (true);\r\n        this.handleError (this.modalTexts.error.title, this.modalTexts.loading.body);\r\n        return EMPTY;\r\n      })\r\n\r\n    ) as Observable<StudentDTO[]>;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\r\n\r\nimport { StudentsRoutingModule } from './students-routing.module';\r\nimport { BootstrapModule } from 'src/app/shared/bootstrap/bootstrap.module';\r\nimport { SharedModule } from 'src/app/shared/shared.module';\r\n\r\nimport { StudentsListComponent } from './students-list/students-list.component';\r\n\r\n@NgModule({\r\n  declarations: [StudentsListComponent],\r\n  imports: [\r\n    CommonModule,\r\n    StudentsRoutingModule,\r\n    ReactiveFormsModule,\r\n    FormsModule,\r\n    BootstrapModule,\r\n    SharedModule\r\n  ]\r\n})\r\nexport class StudentsModule { }\r\n"]}