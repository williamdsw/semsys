!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=i(e);if(t){var c=i(this).constructor;n=Reflect.construct(r,arguments,c)}else n=r.apply(this,arguments);return o(this,n)}}function o(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"8r/t":function(o,i,c){"use strict";c.r(i),c.d(i,"ProfileModule",function(){return L});var a=c("ofXK"),s=c("tyNb"),l=c("quSY"),b=c("EY2u"),u=c("lJxs"),f=c("JIr8"),g=c("AytR"),p=c("kpR/"),d=c("0OAS"),m=c("fXoL"),h=c("sYmb"),v=c("n90K"),O=c("xaOb"),w=c("Avbo"),y=c("VQPA"),x=["userImage"];function P(e,t){if(1&e){var n=m.Pb();m.Ob(0,"div",6),m.Ob(1,"div",7),m.Ob(2,"div",3),m.Ob(3,"div",8),m.Ob(4,"div",9),m.Vb("click",function(){return m.mc(n),m.kc(7).click()}),m.Ob(5,"input",10),m.Vb("change",function(e){return m.mc(n),m.Xb().onChange(e)}),m.Nb(),m.Kb(6,"label",11,12),m.Kb(8,"img",13,14),m.Ob(10,"div",15),m.Ob(11,"p",16),m.uc(12),m.Yb(13,"translate"),m.Nb(),m.Nb(),m.Nb(),m.Nb(),m.Nb(),m.Ob(14,"div",3),m.Ob(15,"div",8),m.Ob(16,"button",17),m.Vb("click",function(){return m.mc(n),m.Xb().onUploadImage()}),m.uc(17),m.Yb(18,"translate"),m.Nb(),m.Nb(),m.Nb(),m.Nb(),m.Ob(19,"div",18),m.Ob(20,"div",19),m.Ob(21,"header"),m.Ob(22,"h5"),m.uc(23),m.Yb(24,"translate"),m.Nb(),m.Nb(),m.Kb(25,"hr"),m.Ob(26,"p",20),m.uc(27),m.Nb(),m.Nb(),m.Nb(),m.Nb()}if(2&e){var r=m.Xb();m.xb(8),m.cc("src",null==r.person?null:r.person.imageUrl,m.oc),m.xb(4),m.wc(" ",m.Zb(13,6,"profile.buttons.change-image")," "),m.xb(4),m.cc("disabled",!r.userImageFile),m.xb(1),m.wc(" ",m.Zb(18,8,"profile.buttons.upload-image")," "),m.xb(6),m.wc(" ",r.isLoading||r.hasError?m.Zb(24,10,"global.menu-links.profile"):r.person.name," "),m.xb(4),m.wc(" ",r.person.email," ")}}function _(e,t){1&e&&(m.Ob(0,"span"),m.uc(1),m.Yb(2,"translate"),m.Nb()),2&e&&(m.xb(1),m.wc(" ",m.Zb(2,1,"global.messages.loading")," ... "))}function I(e,t){if(1&e&&(m.Ob(0,"div",21),m.sc(1,_,3,3,"span",22),m.Nb()),2&e){var n=m.Xb(),r=m.kc(7);m.xb(1),m.cc("ngIf",!n.hasError)("ngIfElse",r)}}function C(e,t){if(1&e){var n=m.Pb();m.Ob(0,"span"),m.uc(1),m.Yb(2,"translate"),m.Nb(),m.Ob(3,"button",23),m.Vb("click",function(){return m.mc(n),m.Xb().loadData()}),m.uc(4),m.Yb(5,"translate"),m.Nb()}2&e&&(m.xb(1),m.wc(" ",m.Zb(2,2,"global.messages.system-error")," "),m.xb(3),m.wc(" ",m.Zb(5,4,"global.buttons.reload")," "))}var M,N,k,E=[{path:"",component:(M=function(o){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(d,o);var i,c,a,s=r(d);function d(t,n,r,o,i){var c;return e(this,d),(c=s.call(this,t,n)).translateService=t,c.storageService=n,c.personService=r,c.imageUtilService=o,c.modalService=i,c.localUser=new p.a,c.person={},c.subscription$=new l.a,Object.assign(c.localUser,n.getLocalUser()),c.userType=c.localUser.getType(),c.isLoading=!1,c.hasError=!1,c}return i=d,(c=[{key:"ngOnInit",value:function(){this.loadData()}},{key:"ngOnDestroy",value:function(){this.subscription$.unsubscribe()}},{key:"loadData",value:function(){var e=this;this.isLoading=!0,this.hasError=!1,this.subscription$=this.personService.findPersonById(this.localUser.getId()).pipe(Object(u.a)(function(t){e.isLoading=!1,e.hasError=!1,Object.assign(e.person,t);var n="".concat(g.a.BUCKET_BASE_URL,"/").concat(e.imageUtilService.buildFileName(e.person.name),".jpg");e.person.imageUrl=n;var r=document.createElement("img");r.src=n,r.addEventListener("error",function(){return e.person.imageUrl=g.a.DEFAULT_AVATAR_IMG})}),Object(f.a)(function(){return e.isLoading=!1,e.hasError=!0,e.modalService.showAlertDanger("modal.titles.error!","global.messages.system-error"),b.a})).subscribe()}},{key:"onChange",value:function(e){1===e.srcElement.files.length&&(this.userImageFile=e.srcElement.files[0],this.blob=URL.createObjectURL(this.userImageFile),this.userImage=this.userImageRef.first.nativeElement,this.userImage.src=this.blob)}},{key:"onUploadImage",value:function(){var e=this;if(this.userImageFile){var t=this.modalService.showWaitModal();setTimeout(function(){e.subscription$=e.personService.updateUserImage(e.userImageFile).subscribe(function(n){var r=n.headers.get("Location");setTimeout(function(){var n=(new Date).getTime();e.person.imageUrl="".concat(r,"?").concat(n),URL.revokeObjectURL(e.blob),e.userImageFile=null,e.modalService.hideModal(t),e.modalService.showAlertSuccess("modal.titles.success","modal.messages.operation-succeed")},100)},function(){e.modalService.hideModal(t),e.modalService.showAlertDanger("modal.titles.error!","global.messages.system-error")})},500)}}}])&&t(i.prototype,c),a&&t(i,a),d}(d.a),M.\u0275fac=function(e){return new(e||M)(m.Jb(h.d),m.Jb(v.a),m.Jb(O.a),m.Jb(w.a),m.Jb(y.a))},M.\u0275cmp=m.Db({type:M,selectors:[["app-profile"]],viewQuery:function(e,t){var n;1&e&&m.Bc(x,!0),2&e&&m.jc(n=m.Wb())&&(t.userImageRef=n)},features:[m.ub],decls:8,vars:2,consts:[[1,"box-wrapper","mx-auto","my-md-5","my-3"],[1,"card"],["class","row no-gutters",4,"ngIf","ngIfElse"],[1,"row"],["spanLoading",""],["spanError",""],[1,"row","no-gutters"],[1,"col-md-4"],[1,"col-12"],[1,"hover-effect","border-right",3,"click"],["type","file","id","userImageInput","accept","image/png, image/jpeg",1,"d-none",3,"change"],["for","userImageInput",1,"d-none"],["userImageLabel",""],["alt","User Profile",1,"card-img","top","img-fluid",3,"src"],["userImage",""],[1,"overlay"],[1,"text-white","h2","my-5"],["type","button",1,"btn","btn-success","w-100",3,"disabled","click"],[1,"col-md-8"],[1,"card-body"],[1,"card-text"],[1,"bg-light","p-3","text-center"],[4,"ngIf","ngIfElse"],["type","button",1,"btn","btn-info","mx-1",3,"click"]],template:function(e,t){if(1&e&&(m.Ob(0,"div",0),m.Ob(1,"div",1),m.sc(2,P,28,12,"div",2),m.Ob(3,"div",3),m.sc(4,I,2,2,"ng-template",null,4,m.tc),m.sc(6,C,6,6,"ng-template",null,5,m.tc),m.Nb(),m.Nb(),m.Nb()),2&e){var n=m.kc(5);m.xb(2),m.cc("ngIf",!t.isLoading&&!t.hasError)("ngIfElse",n)}},directives:[a.l],pipes:[h.c],styles:[".box-wrapper[_ngcontent-%COMP%]{width:50rem;max-width:50rem}.box-wrapper[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .user-image[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.box-wrapper[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .user-image[_ngcontent-%COMP%]   .card-img[_ngcontent-%COMP%]{max-width:200px;max-height:200px;border:1px solid rgba(0,0,0,.2)}.box-wrapper[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .user-image[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:200px;max-width:200px}.box-wrapper[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   p.user-information[_ngcontent-%COMP%]{font-size:16px}.hover-effect[_ngcontent-%COMP%]{min-width:200px;min-height:200px;width:100%;height:100%;overflow:hidden;position:relative;text-align:center}.hover-effect[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{min-width:inherit;min-height:inherit}.hover-effect[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{width:inherit;height:inherit;overflow:inherit;position:absolute;top:0;left:0;opacity:0;background-color:rgba(0,0,0,.5);transition:all .4s ease-in-out;cursor:none}.hover-effect[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .overlay-button[_ngcontent-%COMP%]{background-color:rgba(0,0,0,0);color:#fff;border:none;outline:none}.hover-effect[_ngcontent-%COMP%]:hover > .overlay[_ngcontent-%COMP%]{opacity:1;filter:alpha(opacity=100);cursor:pointer}@media only screen and (max-width:425px){.box-wrapper[_ngcontent-%COMP%]{width:100%;max-width:100%}}"]}),M)}],U=((N=function t(){e(this,t)}).\u0275mod=m.Hb({type:N}),N.\u0275inj=m.Gb({factory:function(e){return new(e||N)},imports:[[s.f.forChild(E)],s.f]}),N),S=c("PCNd"),j=c("tZSt"),L=((k=function t(){e(this,t)}).\u0275mod=m.Hb({type:k}),k.\u0275inj=m.Gb({factory:function(e){return new(e||k)},imports:[[a.c,U,S.a,j.a]]}),k)}}])}();
//# sourceMappingURL=14-es5.c69abb5c60ae0a26e5d5.js.map