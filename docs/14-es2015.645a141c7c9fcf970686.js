(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"8r/t":function(e,t,n){"use strict";n.r(t),n.d(t,"ProfileModule",function(){return _});var i=n("ofXK"),o=n("tyNb"),r=n("quSY"),s=n("EY2u"),a=n("lJxs"),c=n("JIr8"),b=n("AytR"),l=n("kpR/"),g=n("0OAS"),h=n("fXoL"),d=n("sYmb"),u=n("n90K"),m=n("xaOb"),p=n("Avbo"),f=n("VQPA");const O=["userImage"];function w(e,t){if(1&e){const e=h.Pb();h.Ob(0,"div",6),h.Ob(1,"div",7),h.Ob(2,"div",3),h.Ob(3,"div",8),h.Ob(4,"div",9),h.Vb("click",function(){return h.mc(e),h.kc(7).click()}),h.Ob(5,"input",10),h.Vb("change",function(t){return h.mc(e),h.Xb().onChange(t)}),h.Nb(),h.Kb(6,"label",11,12),h.Kb(8,"img",13,14),h.Ob(10,"div",15),h.Ob(11,"p",16),h.uc(12),h.Yb(13,"translate"),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Ob(14,"div",3),h.Ob(15,"div",8),h.Ob(16,"button",17),h.Vb("click",function(){return h.mc(e),h.Xb().onUploadImage()}),h.uc(17),h.Yb(18,"translate"),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Ob(19,"div",18),h.Ob(20,"div",19),h.Ob(21,"header"),h.Ob(22,"h5"),h.uc(23),h.Yb(24,"translate"),h.Nb(),h.Nb(),h.Kb(25,"hr"),h.Ob(26,"p",20),h.uc(27),h.Nb(),h.Nb(),h.Nb(),h.Nb()}if(2&e){const e=h.Xb();h.xb(8),h.cc("src",null==e.person?null:e.person.imageUrl,h.oc),h.xb(4),h.wc(" ",h.Zb(13,6,"profile.buttons.change-image")," "),h.xb(4),h.cc("disabled",!e.userImageFile),h.xb(1),h.wc(" ",h.Zb(18,8,"profile.buttons.upload-image")," "),h.xb(6),h.wc(" ",e.isLoading||e.hasError?h.Zb(24,10,"global.menu-links.profile"):e.person.name," "),h.xb(4),h.wc(" ",e.person.email," ")}}function v(e,t){1&e&&(h.Ob(0,"span"),h.uc(1),h.Yb(2,"translate"),h.Nb()),2&e&&(h.xb(1),h.wc(" ",h.Zb(2,1,"global.messages.loading")," ... "))}function x(e,t){if(1&e&&(h.Ob(0,"div",21),h.sc(1,v,3,3,"span",22),h.Nb()),2&e){const e=h.Xb(),t=h.kc(7);h.xb(1),h.cc("ngIf",!e.hasError)("ngIfElse",t)}}function y(e,t){if(1&e){const e=h.Pb();h.Ob(0,"span"),h.uc(1),h.Yb(2,"translate"),h.Nb(),h.Ob(3,"button",23),h.Vb("click",function(){return h.mc(e),h.Xb().loadData()}),h.uc(4),h.Yb(5,"translate"),h.Nb()}2&e&&(h.xb(1),h.wc(" ",h.Zb(2,2,"global.messages.system-error")," "),h.xb(3),h.wc(" ",h.Zb(5,4,"global.buttons.reload")," "))}const I=[{path:"",component:(()=>{class e extends g.a{constructor(e,t,n,i,o){super(e,t),this.translateService=e,this.storageService=t,this.personService=n,this.imageUtilService=i,this.modalService=o,this.localUser=new l.a,this.person={},this.subscription$=new r.a,Object.assign(this.localUser,t.getLocalUser()),this.userType=this.localUser.getType(),this.isLoading=!1,this.hasError=!1}ngOnInit(){this.loadData()}ngOnDestroy(){this.subscription$.unsubscribe()}loadData(){this.isLoading=!0,this.hasError=!1,this.subscription$=this.personService.findPersonById(this.localUser.getId()).pipe(Object(a.a)(e=>{this.isLoading=!1,this.hasError=!1,Object.assign(this.person,e);const t=`${b.a.BUCKET_BASE_URL}/${this.imageUtilService.buildFileName(this.person.name)}.jpg`;this.person.imageUrl=t;const n=document.createElement("img");n.src=t,n.addEventListener("error",()=>this.person.imageUrl=b.a.DEFAULT_AVATAR_IMG)}),Object(c.a)(()=>(this.isLoading=!1,this.hasError=!0,this.modalService.showAlertDanger("modal.titles.error!","global.messages.system-error"),s.a))).subscribe()}onChange(e){1===e.srcElement.files.length&&(this.userImageFile=e.srcElement.files[0],this.blob=URL.createObjectURL(this.userImageFile),this.userImage=this.userImageRef.first.nativeElement,this.userImage.src=this.blob)}onUploadImage(){if(this.userImageFile){const e=this.modalService.showWaitModal();setTimeout(()=>{this.subscription$=this.personService.updateUserImage(this.userImageFile).subscribe(t=>{const n=t.headers.get("Location");setTimeout(()=>{const t=(new Date).getTime();this.person.imageUrl=`${n}?${t}`,URL.revokeObjectURL(this.blob),this.userImageFile=null,this.modalService.hideModal(e),this.modalService.showAlertSuccess("modal.titles.success","modal.messages.operation-succeed")},100)},()=>{this.modalService.hideModal(e),this.modalService.showAlertDanger("modal.titles.error!","global.messages.system-error")})},500)}}}return e.\u0275fac=function(t){return new(t||e)(h.Jb(d.d),h.Jb(u.a),h.Jb(m.a),h.Jb(p.a),h.Jb(f.a))},e.\u0275cmp=h.Db({type:e,selectors:[["app-profile"]],viewQuery:function(e,t){if(1&e&&h.Bc(O,!0),2&e){let e;h.jc(e=h.Wb())&&(t.userImageRef=e)}},features:[h.ub],decls:8,vars:2,consts:[[1,"box-wrapper","w-100","mx-auto","my-md-5","my-3"],[1,"card"],["class","row no-gutters",4,"ngIf","ngIfElse"],[1,"row"],["spanLoading",""],["spanError",""],[1,"row","no-gutters"],[1,"col-md-4"],[1,"col-12"],[1,"hover-effect","border-right",3,"click"],["type","file","id","userImageInput","accept","image/png, image/jpeg",1,"d-none",3,"change"],["for","userImageInput",1,"d-none"],["userImageLabel",""],["alt","User Profile",1,"card-img","top","img-fluid",3,"src"],["userImage",""],[1,"overlay"],[1,"text-white","h2","my-5"],["type","button",1,"btn","btn-success","w-100",3,"disabled","click"],[1,"col-md-8"],[1,"card-body"],[1,"card-text"],[1,"bg-light","p-3","text-center"],[4,"ngIf","ngIfElse"],["type","button",1,"btn","btn-info","mx-1",3,"click"]],template:function(e,t){if(1&e&&(h.Ob(0,"div",0),h.Ob(1,"div",1),h.sc(2,w,28,12,"div",2),h.Ob(3,"div",3),h.sc(4,x,2,2,"ng-template",null,4,h.tc),h.sc(6,y,6,6,"ng-template",null,5,h.tc),h.Nb(),h.Nb(),h.Nb()),2&e){const e=h.kc(5);h.xb(2),h.cc("ngIf",!t.isLoading&&!t.hasError)("ngIfElse",e)}},directives:[i.l],pipes:[d.c],styles:[".box-wrapper[_ngcontent-%COMP%]{width:50rem;max-width:50rem}.box-wrapper[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .user-image[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}.box-wrapper[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .user-image[_ngcontent-%COMP%]   .card-img[_ngcontent-%COMP%]{max-width:200px;max-height:200px;border:1px solid rgba(0,0,0,.2)}.box-wrapper[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .user-image[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:200px;max-width:200px}.box-wrapper[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   p.user-information[_ngcontent-%COMP%]{font-size:16px}.hover-effect[_ngcontent-%COMP%]{min-width:200px;min-height:200px;width:100%;height:100%;overflow:hidden;position:relative;text-align:center}.hover-effect[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{min-width:inherit;min-height:inherit}.hover-effect[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{width:inherit;height:inherit;overflow:inherit;position:absolute;top:0;left:0;opacity:0;background-color:rgba(0,0,0,.5);transition:all .4s ease-in-out;cursor:none}.hover-effect[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .overlay-button[_ngcontent-%COMP%]{background-color:rgba(0,0,0,0);color:#fff;border:none;outline:none}.hover-effect[_ngcontent-%COMP%]:hover > .overlay[_ngcontent-%COMP%]{opacity:1;filter:alpha(opacity=100);cursor:pointer}@media only screen and (max-width:425px){.box-wrapper[_ngcontent-%COMP%]{width:100%;max-width:100%}}"]}),e})()}];let P=(()=>{class e{}return e.\u0275mod=h.Hb({type:e}),e.\u0275inj=h.Gb({factory:function(t){return new(t||e)},imports:[[o.f.forChild(I)],o.f]}),e})();var C=n("PCNd"),M=n("tZSt");let _=(()=>{class e{}return e.\u0275mod=h.Hb({type:e}),e.\u0275inj=h.Gb({factory:function(t){return new(t||e)},imports:[[i.c,P,C.a,M.a]]}),e})()}}]);
//# sourceMappingURL=14-es2015.645a141c7c9fcf970686.js.map